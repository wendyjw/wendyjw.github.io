<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>cookie 、localStorage 、sessionStorage 以及 H5 缓存 | 吴文君的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="cookie 详解存储 cookie 是浏览器的功能，浏览器下有一个 cookie 文件夹专门存放各个域下设置的 cookie，cookie 是存储在浏览器的纯文本 当网页要发 http 请求时，浏览器会先检查是否有相应的 cookie，有则自动添加在 request header 中的 cookie 字段中。这些是浏览器自动帮我们做的，而且每一次 http 请求浏览器都会自动帮我们做 cooki">
<meta property="og:type" content="article">
<meta property="og:title" content="cookie 、localStorage 、sessionStorage 以及 H5 缓存">
<meta property="og:url" content="https://wendyjw.github.io/project/2017/03/08/cookie%20%E3%80%81localStorage%20%E3%80%81sessionStorage%20%E4%BB%A5%E5%8F%8A%20H5%20%E7%BC%93%E5%AD%98/index.html">
<meta property="og:site_name" content="吴文君的博客">
<meta property="og:description" content="cookie 详解存储 cookie 是浏览器的功能，浏览器下有一个 cookie 文件夹专门存放各个域下设置的 cookie，cookie 是存储在浏览器的纯文本 当网页要发 http 请求时，浏览器会先检查是否有相应的 cookie，有则自动添加在 request header 中的 cookie 字段中。这些是浏览器自动帮我们做的，而且每一次 http 请求浏览器都会自动帮我们做 cooki">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2017-03-07T16:00:00.000Z">
<meta property="article:modified_time" content="2025-02-19T09:10:26.874Z">
<meta property="article:author" content="wuwenjun">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/project/atom.xml" title="吴文君的博客" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/project/favicon.png">
  
  
  
<link rel="stylesheet" href="/project/css/style.css">

  
    
<link rel="stylesheet" href="/project/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/project/" id="logo">吴文君的博客</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/project/" id="subtitle">技术记录</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/project/">Home</a>
        
          <a class="main-nav-link" href="/project/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/project/atom.xml" title="RSS 订阅"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="搜索"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://wendyjw.github.io/project"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-cookie 、localStorage 、sessionStorage 以及 H5 缓存" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/project/2017/03/08/cookie%20%E3%80%81localStorage%20%E3%80%81sessionStorage%20%E4%BB%A5%E5%8F%8A%20H5%20%E7%BC%93%E5%AD%98/" class="article-date">
  <time class="dt-published" datetime="2017-03-07T16:00:00.000Z" itemprop="datePublished">2017-03-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      cookie 、localStorage 、sessionStorage 以及 H5 缓存
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="cookie-详解"><a href="#cookie-详解" class="headerlink" title="cookie 详解"></a>cookie 详解</h2><p>存储 cookie 是浏览器的功能，浏览器下有一个 cookie 文件夹专门存放各个域下设置的 cookie，cookie 是存储在浏览器的纯文本</p>
<p>当网页要发 http 请求时，浏览器会先检查是否有相应的 cookie，有则自动添加在 request header 中的 cookie 字段中。这些是浏览器自动帮我们做的，而且每一次 http 请求浏览器都会自动帮我们做</p>
<h3 id="cookie-的格式"><a href="#cookie-的格式" class="headerlink" title="cookie 的格式"></a>cookie 的格式</h3><ol>
<li>document.cookie<br>原生 js 获取 cookie 的方法，得到一个字符串，但这个字符串是有格式的，由键值对 key&#x3D;value 构成，键值对之间由一个分号和一个空格隔开。</li>
</ol>
<p>“key&#x3D;value; key&#x3D;value”<br>cookie 属性选项<br>包括：expires、domain、path、secure、HttpOnly，</p>
<p>在设置任一个 cookie 时都可以设置相关的这些属性，当然也可以不设置，这时会使用这些属性的默认值。在设置这些属性时，属性之间由一个分号和一个空格隔开。如下：</p>
<p>“key&#x3D;name; expires&#x3D;Thu, 25 Feb 2016 04:18:00 GMT;domain&#x3D;ppsc.sankuai.com; path&#x3D;&#x2F;; secure; HttpOnly”<br>expires<br>expires 选项用来设置“cookie 什么时间内有效”。expires 其实是 cookie 失效日期，expires 必须是 GMT 格式的时间（可以通过 new Date().toGMTString()或者 new Date().toUTCString()来获得）。</p>
<p>expires 的值是一个时间点（cookie 失效时刻&#x3D; expires）; 如 expires&#x3D;Thu, 25 Feb 2016 04:18:00 GMT 表示 cookie 讲在 2016 年 2 月 25 日 4:18 分之后失效，对于失效的 cookie 浏览器会清空。如果没有设置该选项，则默认有效期为 session，即会话 cookie。这种 cookie 在浏览器关闭后就没有了。</p>
<p>http&#x2F;1.0 协议，cookie 被 max-age 代替，max-age 的值是一个以秒为单位时间段（cookie 失效时刻&#x3D; 创建时刻+ max-age）。</p>
<ol start="2">
<li><p>domain 和 path<br>domain 是域名，path 是路径，两者加起来就构成了 URL，domain 和 path 一起来限制 cookie 能被哪些 URL 访问。</p>
</li>
<li><p>secure<br>secure 选项用来设置 cookie 只在确保安全的请求中才会发送。当请求是 HTTPS 或者其他安全协议时，包含 secure 选项的 cookie 才能被发送至服务器。</p>
</li>
</ol>
<p>默认情况下，cookie 不会带 secure 选项(即为空)。所以默认情况下，不管是 HTTPS 协议还是 HTTP 协议的请求，cookie 都会被发送至服务端。但要注意一点，secure 选项只是限定了在安全情况下才可以传输给服务端，但并不代表你不能看到这个 cookie。</p>
<p>document.cookie&#x3D;”name&#x3D;king; secure”<br>如果想在客户端即网页中通过 js 去设置 secure 类型的 cookie，必须保证网页是 https 协议的。在 http 协议的网页中是无法设置 secure 类型 cookie 的。</p>
<ol start="4">
<li>httpOnly<br>这个选项用来设置 cookie 是否能通过 js 去访问。默认情况下，cookie 不会带 httpOnly 选项(即为空)，所以默认情况下，客户端是可以通过 js 代码去访问（包括读取、修改、删除等）这个 cookie 的。当 cookie 带 httpOnly 选项时，客户端则无法通过 js 代码去访问（包括读取、修改、删除等）这个 cookie。</li>
</ol>
<p>在客户端是不能通过 js 代码去设置一个 httpOnly 类型的 cookie 的，这种类型的 cookie 只能通过服务端来设置。</p>
<h3 id="如何设置-cookie"><a href="#如何设置-cookie" class="headerlink" title="如何设置 cookie"></a>如何设置 cookie</h3><h4 id="服务端客户端均可设置-cookie"><a href="#服务端客户端均可设置-cookie" class="headerlink" title="服务端客户端均可设置 cookie"></a>服务端客户端均可设置 cookie</h4><ol>
<li>服务端<br>不管你是请求一个资源文件（如 html&#x2F;js&#x2F;css&#x2F;图片），还是发送一个 ajax 请求，服务端都会返回 response。而 response header 中有一项叫 set-cookie，是服务端专门用来设置 cookie 的。如下图所示，服务端返回的 response header 中有 5 个 set-cookie 字段，每个字段对应一个 cookie（注意不能将多个 cookie 放在一个 set-cookie 字段中），set-cookie 字段的值就是普通的字符串，每个 cookie 还设置了相关属性选项。</li>
</ol>
<p>一个 set-Cookie 字段只能设置一个 cookie，当你要想设置多个 cookie，需要添加同样多的 set-Cookie 字段。</p>
<p>服务端可以设置 cookie 的所有选项：expires、domain、path、secure、HttpOnly</p>
<ol start="2">
<li>客户端设置 cookie<br>js 代码实现：<br><code>document.cookie=&quot;xxx=yyy&quot;</code><br>客户端可以设置 cookie 的下列选项：expires、domain、path、secure（有条件：只有在 https 协议的网页中，客户端设置 secure 类型的 cookie 才能成功），但无法设置 HttpOnly 选项</li>
</ol>
<p>js 设置多个 cookie，一次只能设置一次成功。所以重复执行</p>
<pre><code>document.cookie=&quot;key=value&quot;：

document.cookie = &quot;name=Jonh&quot;;

document.cookie = &quot;age=12&quot;;

document.cookie = &quot;class=111&quot;;
</code></pre>
<h4 id="修改、删除-cookie"><a href="#修改、删除-cookie" class="headerlink" title="修改、删除 cookie"></a>修改、删除 cookie</h4><ol>
<li><p>修改：<br>要想修改一个 cookie，只需要重新赋值就行，旧的值会被新的值覆盖。但要注意一点，在设置新 cookie 时，path&#x2F;domain 这几个选项一定要旧 cookie 保持一样。否则不会修改旧值，而是添加了一个新的 cookie。</p>
</li>
<li><p>删除：<br>删除一个 cookie 也是重新赋值，只要将这个新 cookie 的 expires 选项设置为一个过去的时间点就行了。但同样要注意，path&#x2F;domain&#x2F;这几个选项一定要旧 cookie 保持一样。</p>
</li>
</ol>
<h4 id="cookie-编码"><a href="#cookie-编码" class="headerlink" title="cookie 编码"></a>cookie 编码</h4><p>cookie 其实是个字符串，但这个字符串中逗号、分号、空格被当做了特殊符号。所以当 cookie 的 key 和 value 中含有这 3 个特殊字符时，需要对其进行额外编码，一般会用 escape 进行编码，读取时用 unescape 进行解码；</p>
<pre><code>var key = (&quot;name;value&quot;);

var value = escape(&quot;this is a value contain , and ;&quot;);

document.cookie= key + &quot;=&quot; + value + &quot;; expires=Thu, 26 Feb 2116 11:50:25 GMT; domain=sankuai.com; path=/&quot;;
一个小例子，页面加载时显示上次保存的信息

function getCookie(c_name) &#123;
  if (document.cookie.length &gt; 0) &#123;
    c_start = document.cookie.indexOf(c_name + &quot;=&quot;)
    if (c_start != -1) &#123;
      c_start = c_start + c_name.length + 1
      c_end = document.cookie.indexOf(&quot;;&quot;, c_start)
    if (c_end == -1) c_end = document.cookie.length
      return unescape(document.cookie.substring(c_start, c_end))
    &#125;
  &#125;
  return &quot;&quot;
&#125;
function setCookie(c_name, value, expiredays) &#123;
    var exdate = new Date()
    exdate.setDate(exdate.getDate() + expiredays)
    document.cookie = c_name + &quot;=&quot; + escape(value) +
    ((expiredays == null) ? &quot;&quot; : &quot;;expires=&quot; + exdate.toGMTString())
    &#125;
    function checkCookie() &#123;
      username = getCookie(&#39;username&#39;)
      if (username != null &amp;&amp; username != &quot;&quot;) &#123;
        alert(&#39;Welcome again &#39; + username + &#39;!&#39;)
      &#125;
      else &#123;
        username = prompt(&#39;Please enter your name:&#39;, &quot;&quot;)
        if (username != null &amp;&amp; username != &quot;&quot;) &#123;
          setCookie(&#39;username&#39;, username, 365)
        &#125;
    &#125;
&#125;
</code></pre>
<h2 id="localStorage-sessionStorage"><a href="#localStorage-sessionStorage" class="headerlink" title="localStorage sessionStorage"></a>localStorage sessionStorage</h2><h3 id="localStorage"><a href="#localStorage" class="headerlink" title="localStorage"></a>localStorage</h3><p>方法存储的数据没有时间限制。</p>
<p>localStorage.lastname&#x3D;”Smith”;</p>
<h3 id="sessionStorage"><a href="#sessionStorage" class="headerlink" title="sessionStorage"></a>sessionStorage</h3><p>方法针对一个 session 进行数据存储。当用户关闭浏览器窗口后，数据会被删除。</p>
<p>sessionStorage.firsrname&#x3D;’king’</p>
<h2 id="H5-应用程序缓存"><a href="#H5-应用程序缓存" class="headerlink" title="H5 应用程序缓存"></a>H5 应用程序缓存</h2><p>HTML5 引入了应用程序缓存，这意味着 web 应用可进行缓存，并可在没有因特网连接时进行访问。</p>
<p>Cache Manifest<br>如需启用应用程序缓存，请在文档的 标签中包含 manifest 属性：</p>
<p>manifest 文件<br>CACHE MANIFEST- 在此标题下列出的文件将在首次下载后进行缓存</p>
<p>NETWORK- 在此标题下列出的文件需要与服务器的连接，且不会被缓存</p>
<p>FALLBACK- 在此标题下列出的文件规定当页面无法访问时的回退页面（比如 404 页面）</p>
<p>一个完整的 manifest 文件<br>CACHE MANIFEST</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://wendyjw.github.io/project/2017/03/08/cookie%20%E3%80%81localStorage%20%E3%80%81sessionStorage%20%E4%BB%A5%E5%8F%8A%20H5%20%E7%BC%93%E5%AD%98/" data-id="cm7bp26o30002qr8z3yhv8zbx" data-title="cookie 、localStorage 、sessionStorage 以及 H5 缓存" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/project/2017/03/08/Set%20%E6%96%B0%E7%94%A8%E6%B3%95/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">前一篇</strong>
      <div class="article-nav-title">
        
          全新 Set 用法
        
      </div>
    </a>
  
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/project/archives/2022/09/">九月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/project/archives/2020/03/">三月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/project/archives/2017/03/">三月 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/project/2022/09/08/%E5%AE%89%E5%8D%93%E8%87%AA%E9%80%82%E5%BA%94%E5%BA%94%E7%94%A8%E5%9B%BE%E6%A0%87/">安卓自适应应用图标</a>
          </li>
        
          <li>
            <a href="/project/2020/03/08/TS%20%E5%B8%B8%E7%94%A8%E7%94%A8%E6%B3%95/">TS 常用用法</a>
          </li>
        
          <li>
            <a href="/project/2020/03/08/echarts%20+%20css3%20%E5%AE%9E%E7%8E%B0%E7%8E%AF%E5%BD%A2%E5%9B%BE%E5%A4%96%E7%8E%AF%E5%8A%A8%E6%95%88/">echarts + css3 实现环形图外环动效.md</a>
          </li>
        
          <li>
            <a href="/project/2017/03/08/Set%20%E6%96%B0%E7%94%A8%E6%B3%95/">全新 Set 用法</a>
          </li>
        
          <li>
            <a href="/project/2017/03/08/cookie%20%E3%80%81localStorage%20%E3%80%81sessionStorage%20%E4%BB%A5%E5%8F%8A%20H5%20%E7%BC%93%E5%AD%98/">cookie 、localStorage 、sessionStorage 以及 H5 缓存</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 wuwenjun<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/project/" class="mobile-nav-link">Home</a>
  
    <a href="/project/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/project/js/jquery-3.6.4.min.js"></script>



  
<script src="/project/fancybox/jquery.fancybox.min.js"></script>




<script src="/project/js/script.js"></script>





  </div>
</body>
</html>